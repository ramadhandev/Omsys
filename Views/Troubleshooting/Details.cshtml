@model OMSys.Models.TroubleshootingView

@{
    Layout = "_LayoutUser";
    ViewData["Title"] = "Detail Troubleshooting";
}

<div class="container mt-4">
    <h3 class="fw-bold text-danger">Detail Troubleshooting</h3>

    <!-- Info Umum -->
    <div class="mb-3">
        <p><strong>Unit:</strong> @Model.UnitName (@Model.Brand)</p>
        <p><strong>Komponen:</strong> @Model.ComponentName</p>
        <p><strong>Gejala:</strong> @Model.SymptomName</p>
    </div>

    <hr />

    <div class="row">
        <!-- Step List Kiri -->
        <div class="col-md-4">
            <ul class="list-group" id="stepList">
                @for (int i = 0; i < Model.Steps.Count; i++)
                {
                    var step = Model.Steps[i];
                    <li class="list-group-item step-item @(i == 0 ? "active" : "")"
                        data-step="@i"
                        style="cursor:pointer;">
                        @($"{i + 1}. {step.Instruction}")
                    </li>
                }
            </ul>
        </div>

        <!-- Detail Step Kanan -->
        <div class="col-md-8">
            @for (int i = 0; i < Model.Steps.Count; i++)
            {
                var step = Model.Steps[i];
                <div class="step-detail" id="step-@i" style="display:@(i == 0 ? "block" : "none");">
                    <p><strong>Instruksi:</strong> @step.Instruction</p>
                    <p><strong>Hasil:</strong> @step.Result</p>

                    @if (!string.IsNullOrEmpty(step.ImagePath))
                    {
                        <div class="mb-2">
                            <img src="@Url.Content(step.ImagePath)"
                                 alt="Step Image"
                                 class="img-thumbnail thumb-img"
                                 style="width: 100px; cursor:pointer;"
                                 data-bs-toggle="modal"
                                 data-bs-target="#imageModal"
                                 data-img="@Url.Content(step.ImagePath)" />
                        </div>
                    }

                    
                    <div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered modal-lg">
                            <div class="modal-content">
                                <div class="modal-body p-0">
                                    <img src="" id="modalImage" class="img-fluid w-100" />
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                                </div>
                            </div>
                        </div>
                    </div>


                    <!-- Tombol Diagnosa & Indikasi -->
                    <button type="button" class="btn btn-outline-info" data-bs-toggle="collapse" data-bs-target="#diag-@i">
                        Lihat Diagnosa & Indikasi
                    </button>

                    <div id="diag-@i" class="collapse mt-2">
                        <p><strong>Diagnosa:</strong> @step.Diagnosis</p>
                        <p><strong>Indikasi & Langkah Perbaikan:</strong> @step.Solution</p>
                    </div>

                    <!-- Tombol Navigasi -->
                    <div class="mt-3 d-flex justify-content-between">
                       <button class="btn btn-secondary prev-step" data-step="@i" disabled="@(i == 0 ? "disabled" : null)">Sebelumnya</button>
<button class="btn btn-primary next-step" data-step="@i" disabled="@(i == Model.Steps.Count - 1 ? "disabled" : null)">Lanjutkan</button>

                    </div>
                </div>
            }
        </div>
    </div>

    <div class="mt-4">
        <a asp-action="Index" class="btn btn-secondary">Kembali</a>
    </div>
</div>



@section Scripts {
    <script src="~/js/Custom.js"></script>
}
